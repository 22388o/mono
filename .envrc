# Fast and persistent use nix implementation (https://github.com/nix-community/nix-direnv)
if ! has nix_direnv_version || ! nix_direnv_version 2.4.0; then
  source_url "https://raw.githubusercontent.com/nix-community/nix-direnv/2.4.0/direnvrc" "sha256-XQzUAvL6pysIJnRJyR7uVpmUSZfc7LSgWQwq/4mBr1U="
fi

# Reload if these files changes
nix_direnv_watch_file ./shell.nix

# Disables loading old devenv script
export SKIP_OLD_DEVENV=true

# Activate nix-shell
use nix

# allow using playnet variables
[[ -f .envrc.playnet ]] && source_env .envrc.playnet

# allow local .envrc overrides
[[ -f .envrc.local ]] && source_env .envrc.local

# allow .envrc overrides in Github Action runners
[[ $GITHUB_ACTIONS == true || $GITHUB_ACTIONS == "true" ]] && source_env .envrc.github-runner
